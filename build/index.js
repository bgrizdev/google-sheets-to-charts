(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,a=window.wp.blockEditor,l=window.wp.components,o=window.wp.element,r=window.wp.apiFetch;var n=e.n(r);(0,t.registerBlockType)("sheets/chart-block",{title:"Sheets Chart Block",icon:"chart-bar",category:"widgets",attributes:{sheetId:{type:"string",default:""},label:{type:"string",default:"A2:A13"},stats:{type:"string",default:"O2:O13"},overlay:{type:"string",default:"B2:B13"}},edit:({attributes:e,setAttributes:t})=>{const{sheetId:r,label:s,stats:c,overlay:h}=e,d=(0,a.useBlockProps)(),[i,p]=(0,o.useState)(""),u=async()=>{p("Fetching...");try{await n()({path:"/sheets-chart/v1/fetch-data",method:"POST",data:{sheetId:r,label:s,stats:c,overlay:h}}),p("Data fetched successfully.")}catch(e){console.error(e),p(`Error: ${e?.message||"Request failed"}`)}};return(0,o.createElement)("div",d,(0,o.createElement)(l.TextControl,{label:"Google Sheet ID",value:r,placeholder:"",onChange:e=>{console.log("Sheet ID changed to:",e),t({sheetId:e})},help:"Paste the ID from the Google Sheet URL"}),(0,o.createElement)(l.TextControl,{label:"Label Range",value:s,placeholder:"A2:A13",onChange:e=>t({label:e}),help:"Enter the range of labels you want to display, Product titles would be A2:A13"}),(0,o.createElement)(l.TextControl,{label:"Stat Range",value:c,placeholder:"A2:A13",onChange:e=>t({label:e}),help:"Enter the range of stats you want to display, Product titles would be O2:O13"}),(0,o.createElement)(l.TextControl,{label:"Overlay Range",value:h,placeholder:"A2:A13",onChange:e=>t({label:e}),help:"Enter the range for the overlay data you want to display, Product prices would be B2:B13"}),(0,o.createElement)(l.Tooltip,{text:"Click this to fetch and cache the Google Sheet data."},(0,o.createElement)(l.Button,{variant:"primary",onClick:u,style:{marginTop:"1rem"}},"Fetch Data")),(0,o.createElement)(l.Tooltip,{text:"If data in the sheet has changed, click this to refresh the data and re-cache it."},(0,o.createElement)(l.Button,{variant:"primary",onClick:u,style:{marginTop:"1rem"}},"Refresh Data")),i&&(0,o.createElement)("p",{style:{marginTop:"0.5rem",fontSize:"12px",color:"#555"}},i))},save:({attributes:e})=>{const{sheetId:t,label:a,stats:l,overlay:r}=e;return(0,o.createElement)("div",{className:"sheets-chart-block","data-sheet-id":t,"data-label":a,"data-stats":l,"data-overlay":r},`Sheet ID: ${t}, Label Range: ${a}`)}})})();